<!DOCTYPE html>
<html lang="ja">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>みかん系統グラフ</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/cytoscape/3.26.0/cytoscape.min.js"></script>
  <link rel="stylesheet"
    href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200&icon_names=filter_list,search" />
  <link rel="stylesheet" href="style.css" />
</head>

<body>
  <header>
    <div class="controls">
      <div id="title">
        <svg xmlns="http://www.w3.org/2000/svg" width="43" height="43">
          <ellipse cx="20" cy="20" rx="20" ry="17" fill="#ff9800" />
          <path d="M20 6 Q25 0 35 3 Q28 8 20 6" fill="green" />
          <path d="M20 8 L20 2" stroke="green" stroke-width="1" />

          <g transform="rotate(-45 21.5 21.5)">
            <line x1="0" y1="19" x2="0" y2="24" stroke="#fff" stroke-width="0.5" opacity="0.5" />
            <line x1="10" y1="19" x2="10" y2="24" stroke="#fff" stroke-width="0.5" opacity="0.5" />
            <line x1="20" y1="19" x2="20" y2="24" stroke="#fff" stroke-width="0.5" opacity="0.5" />
            <line x1="30" y1="19" x2="30" y2="24" stroke="#fff" stroke-width="0.5" opacity="0.5" />
            <line x1="40" y1="19" x2="40" y2="24" stroke="#fff" stroke-width="0.5" opacity="0.5" />

            <path d="M -5 21.5 Q 2.5 11.5 10 21.5 T 25 21.5 T 40 21.5 T 55 21.5" fill="none" stroke="#2196F3"
              stroke-width="1.5" />

            <path d="M -5 21.5 Q 2.5 31.5 10 21.5 T 25 21.5 T 40 21.5 T 55 21.5" fill="none" stroke="#F44336"
              stroke-width="1.5" />
          </g>
        </svg>

        <strong>みかん家系図検索</strong>
      </div>

      <div id="search-area">

        <button onclick="redraw()">
          <span class="material-symbols-outlined">search</span>
        </button>
        <input type="text" id="mikanSearch" list="mikanList" placeholder="柑橘を検索(例:せとか)">
        <input type="hidden" id="targetId" value="61">
        <datalist id="mikanList"></datalist>
      </div>

    </div>
  </header>
  <button id="filter-list-button">
    <span class="material-symbols-outlined">filter_list</span>
  </button>

  <div id="drawer-overlay"></div>

  <div id="filter-drawer">

    <button id="close-drawer">&times;</button>
    <div class="drawer-content">
      <div class="drawer-header">
        <h3>設定</h3>
      </div>
      <ul id="filters">
        <li>
          <label class="mikan-switch">
            <input type="checkbox" id="directOnlyCheck" onchange="redraw()">
            <span class="slider"></span>
          </label>
          <span>直系のみ表示</span>
        </li>
        <li>

          <label>表示範囲:
            <input type="number" id="hops" value="3" min="1" max="5" style="width: 45px; padding: 5px;"> 親等まで
          </label>
        </li>
        <li> <button onclick="redraw()">再描画</button>
        </li>
        <li>
          <h4>プリセット</h4>
          <div class="preset-container">
            <button class="preset-btn" onclick="setPreset(0)">温州みかん</button>
            <button class="preset-btn" onclick="setPreset(61)">清見</button>
            <button class="preset-btn" onclick="setPreset(100)">宮川早生</button>
            <button class="preset-btn" onclick="setPreset(8)">クネンボ</button>
            <button class="preset-btn" onclick="setPreset(4)">文旦</button>
            <button class="preset-btn" onclick="setPreset(1)">オレンジ</button>
            <button class="preset-btn" onclick="setPreset(3)">マンダリン(分類名)</button>
            <button class="preset-btn" onclick="setPreset(400)">紅まどんな</button>
            <button class="preset-btn" onclick="setPreset(300)">せとか</button>
            <button class="preset-btn" onclick="setPreset(301)">甘平</button>
          </div>
        </li>
      </ul>

      <div class="drawer-header">
        <h3>使い方・見方</h3>
      </div>
      <div id="how-to-use">
        <ul>
          <li>
            矢印の向かう方向が遺伝の方向です
          </li>
          <li>
            タップした柑橘を中心に親戚順に遠く配置されます
          </li>
          <li>
            ハイライトされた矢印は直系の親戚たちです<br>
            <span style="color:#00ad46">→</span>: 緑色は祖先関係を表します<br>
            <span style="color:#fa2">→</span> : オレンジ色は子孫関係を表します<br>
            <span style="color:#aaa">→</span> : 灰色は直系以外の関係です<br>
          </li>

        </ul>
      </div>
      <div class="drawer-header">
        <h3>参考</h3>
      </div>
      <ul id="reference">
        <li>
          <a href="https://www.kajuen.co.jps">のま果樹園</a>
        </li>
        <li>
          <a href="https://www.naro.go.jp">農研機構</a>
        </li>
        <li>
          <a href="https://www.kudamononavi.com/">果物ナビ</a>
        </li>
        <li>
          <a href="https://www.nig.ac.jp/nig/images/research_highlights/PR20170106.pdfa">国立遺伝学研究所より</a>
        </li>
      </ul>

    </div>
    <div id="copyright">Copyright (c) 2025 Masato Shuto (ms-yozakura on Github). All Rights Reserved.</div>

  </div>
  <div id="cy"></div>
  <div id="info-panel" class="info-panel"></div>
  <script src="script.js">
  </script>
</body>

</html>
